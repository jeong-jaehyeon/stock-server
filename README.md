# π“ Stock Portfolio API (μ£Όμ‹ ν¬νΈν΄λ¦¬μ¤ κ΄€λ¦¬ μ„λΉ„μ¤)

μ΄ ν”„λ΅μ νΈλ” μ‚¬μ©μκ°€ μμ‹ μ **μ£Όμ‹ ν¬νΈν΄λ¦¬μ¤λ¥Ό κ΄€λ¦¬**ν•  μ μλ„λ΅ ν•λ” μ›Ή μ„λΉ„μ¤μ…λ‹λ‹¤.  
Twelve Data APIλ¥Ό ν™μ©ν•μ—¬ **μ‹¤μ‹κ°„ μ£Όκ°€ λ°μ΄ν„° μ΅°ν λ° ν¬νΈν΄λ¦¬μ¤ κ΄€λ¦¬** κΈ°λ¥μ„ μ κ³µν•©λ‹λ‹¤.

---

## π“ 1. ν”„λ΅μ νΈ κ°μ”

- **ν”„λ΅ νΈμ—”λ“**: μ¶”ν›„ κµ¬ν„ μμ •
- **λ°±μ—”λ“**: Express.js + TypeScript
- **λ°μ΄ν„°λ² μ΄μ¤**: MariaDB + Sequelize
- **API μ κ³µ**: Twelve Data API μ‚¬μ©

---

## π“ 2. ν”„λ΅μ νΈ μ„¤μΉ λ° μ‹¤ν–‰

### 1οΈβƒ£ ν”„λ΅μ νΈ ν΄λ΅  λ° ν™κ²½ μ„¤μ •
```bash
git clone https://github.com/wolgus104@naver.com/stock-server.git
cd stock-server
yarn install
```

### 2οΈβƒ£ ν™κ²½ λ³€μ μ„¤μ • (`.env` νμΌ)
`.env` νμΌμ„ ν”„λ΅μ νΈ λ£¨νΈμ— μƒμ„± ν›„, μ•„λ λ‚΄μ©μ„ μ¶”κ°€:
```env
PORT=3000
DATABASE_USER=root
DATABASE_PASSWORD=yourpassword
DATABASE_NAME=stock_db
DATABASE_HOST=localhost
DATABASE_DIALECT=mariadb
TWELVE_DATA_API_KEY=your_api_key
```

### 3οΈβƒ£ λ°μ΄ν„°λ² μ΄μ¤ μ΄κΈ°ν™”
```bash
yarn db:migrate
```

### 4οΈβƒ£ μ„λ²„ μ‹¤ν–‰
```bash
yarn dev
```

---

## π“ 3. API μ‚¬μ©λ²•

### **1οΈβƒ£ μ£Όμ‹ κ²€μƒ‰ (μ‹¤μ‹κ°„ μ‹μ„Έ μ΅°ν)**
π“ νΉμ • μ£Όμ‹μ μ‹¤μ‹κ°„ λ°μ΄ν„°λ¥Ό μ΅°νν•©λ‹λ‹¤.
```http
GET /api/stocks?symbol=AAPL
```
π“ **μ‘λ‹µ μμ‹**
```json
{
  "symbol": "AAPL",
  "name": "Apple Inc.",
  "price": 150.50,
  "currency": "USD",
  "exchange": "NASDAQ"
}
```

---

### **2οΈβƒ£ ν¬νΈν΄λ¦¬μ¤ μ¶”κ°€ (λ§¤μ)**
π“ μ‚¬μ©μμ ν¬νΈν΄λ¦¬μ¤μ— μ£Όμ‹μ„ μ¶”κ°€ν•©λ‹λ‹¤.
```http
POST /api/portfolio
```
π“ **μ”μ²­ λ°”λ””**
```json
{
  "symbol": "AAPL",
  "buyPrice": 150.5,
  "quantity": 10
}
```
π“ **μ‘λ‹µ μμ‹**
```json
{
  "id": 1,
  "symbol": "AAPL",
  "buyPrice": 150.5,
  "quantity": 10,
  "createdAt": "2024-02-10T12:00:00Z"
}
```

β… **κΈ°λ¥ μ„¤λ…**
- κ°™μ€ μ£Όμ‹μ„ **μ¤‘λ³µ μ¶”κ°€ν•λ©΄ ν‰κ·  λ§¤μ λ‹¨κ°€ μ΅°μ •**
- κΈ°μ΅΄ λ³΄μ  μ£Όμ‹ μλ‰ μ—…λ°μ΄νΈ
- κ±°λ λ‚΄μ—­(`trade_history`) ν…μ΄λΈ”μ— `BUY` κΈ°λ΅ μ¶”κ°€λ¨

---

### **3οΈβƒ£ ν¬νΈν΄λ¦¬μ¤ μ΅°ν**
π“ μ‚¬μ©μμ ν„μ¬ ν¬νΈν΄λ¦¬μ¤λ¥Ό μ΅°νν•©λ‹λ‹¤.
```http
GET /api/portfolio
```
π“ **μ‘λ‹µ μμ‹**
```json
[
  {
    "symbol": "AAPL",
    "name": "Apple Inc.",
    "quantity": 10,
    "buyPrice": 150.5,
    "currentPrice": 155.0,
    "profitLoss": 4.5
  }
]
```

β… **κΈ°λ¥ μ„¤λ…**
- ν„μ¬ ν¬νΈν΄λ¦¬μ¤μ **λ³΄μ  μ£Όμ‹ λ©λ΅, μλ‰, ν‰κ·  λ§¤μ λ‹¨κ°€ μ΅°ν**
- ν„μ¬κ°€(`currentPrice`)μ™€ **μμµλ¥ (`profitLoss`) κ³„μ‚°ν•μ—¬ μ κ³µ**

---

### **4οΈβƒ£ ν¬νΈν΄λ¦¬μ¤μ—μ„ μ£Όμ‹ λ§¤λ„**
π“ ν¬νΈν΄λ¦¬μ¤μ—μ„ νΉμ • μ£Όμ‹μ„ λ§¤λ„ν•©λ‹λ‹¤.
```http
POST /api/portfolio/sell/AAPL
```
π“ **μ”μ²­ λ°”λ””**
```json
{
  "sellPrice": 160,
  "quantity": 5
}
```
π“ **μ‘λ‹µ μμ‹**
```json
{
  "message": "AAPL μ£Όμ‹μ„ 5κ° λ§¤λ„ μ™„λ£.",
  "remainingQuantity": 5,
  "profitLoss": 50
}
```

β… **κΈ°λ¥ μ„¤λ…**
- λ³΄μ  μ£Όμ‹μ μΌλ¶€λ§ λ§¤λ„ν•  κ²½μ°, **λ‚¨μ€ μλ‰ μ—…λ°μ΄νΈ**
- **μ „λ‰ λ§¤λ„ μ‹ ν¬νΈν΄λ¦¬μ¤μ—μ„ μ‚­μ **
- κ±°λ λ‚΄μ—­(`trade_history`) ν…μ΄λΈ”μ— `SELL` κΈ°λ΅ μ¶”κ°€λ¨
- λ§¤λ„ μ‹ λ°μƒν• μμµ/μ†μ‹¤(`profitLoss`) κ³„μ‚°λ¨

---

### **5οΈβƒ£ ν¬νΈν΄λ¦¬μ¤μ—μ„ μ£Όμ‹ μ‚­μ **
π“ ν¬νΈν΄λ¦¬μ¤μ—μ„ νΉμ • μ£Όμ‹μ„ μ™„μ „ν μ κ±°ν•©λ‹λ‹¤.
```http
DELETE /api/portfolio/AAPL
```
π“ **μ‘λ‹µ μμ‹**
```json
{
  "message": "AAPL removed from portfolio"
}
```

β… **κΈ°λ¥ μ„¤λ…**
- ν¬νΈν΄λ¦¬μ¤μ—μ„ **ν•΄λ‹Ή μ£Όμ‹μ„ μ™„μ „ν μ‚­μ **
- κ±°λ λ‚΄μ—­(`trade_history`)μ—λ” μν–¥μ„ μ£Όμ§€ μ•μ

---

## π“ 4. ν„μ¬κΉμ§€ μ§„ν–‰ν• μ‘μ—…
β… Express + TypeScript + Sequelize μ΄κΈ° μ„¤μ • μ™„λ£  
β… MariaDB μ—°κ²° λ° `stock_db` μƒμ„±  
β… Twelve Data API μ—°λ™ν•μ—¬ μ£Όμ‹ λ°μ΄ν„° μ΅°ν κµ¬ν„  
β… ν¬νΈν΄λ¦¬μ¤ λ°μ΄ν„°λ² μ΄μ¤ ν…μ΄λΈ” μƒμ„± (`portfolio`)  
β… ν¬νΈν΄λ¦¬μ¤ μ¶”κ°€ (`POST /api/portfolio`) κΈ°λ¥ κµ¬ν„  
β… ν¬νΈν΄λ¦¬μ¤ μ‚­μ  (`DELETE /api/portfolio/:symbol`) API κµ¬ν„  
β… ν¬νΈν΄λ¦¬μ¤ μ΅°ν (`GET /api/portfolio`) API κµ¬ν„  
β… λ§¤λ„ κΈ°λ¥ (`POST /api/portfolio/sell/:symbol`) κµ¬ν„ μ™„λ£  
β… `trade_history` ν…μ΄λΈ” μ¶”κ°€ λ° **λ§¤μ/λ§¤λ„ λ‚΄μ—­ κΈ°λ΅ κΈ°λ¥ λ°μ**  
β… `profitLoss`(μμµ/μ†μ‹¤) κ³„μ‚° κΈ°λ¥ μ¶”κ°€

---

## π“ 5. μ•μΌλ΅ ν•  μ‘μ—…
π” ν¬νΈν΄λ¦¬μ¤ μ¶”κ°€ μ‹, **μ¤‘λ³µ μ£Όμ‹ μ²λ¦¬ λ° ν‰κ·  λ§¤μκ°€ κ³„μ‚°**  
π” ν¬νΈν΄λ¦¬μ¤ μ΅°ν μ‹, **ν„μ¬ μ£Όκ°€ λ° μ†μµλ¥  κ³„μ‚° μ¶”κ°€**  
π” ν¬νΈν΄λ¦¬μ¤ μμ • κΈ°λ¥ μ¶”κ°€ (λ§¤μ λ‹¨κ°€ λ³€κ²½ κ°€λ¥ν•κ²)  
π” ν”„λ΅ νΈμ—”λ“ κ°λ° μ‹μ‘ (μ¶”ν›„ μ§„ν–‰)  
π” Postman λ§ν¬ μ¶”κ°€ μμ •

---

## π“ 6. API ν…μ¤νΈ (Postman)
PostmanμΌλ΅ APIλ¥Ό ν…μ¤νΈν•  μ μμµλ‹λ‹¤.  
π“ **Postman λ§ν¬ μ¶”κ°€ μμ •**

---

## π“ 7. κΈ°νƒ€
- **λ¬Έμ:** `wolgus104@naver.com`
- **API λ¬Έμ„:** Postman λ§ν¬ μ¶”κ°€ μμ •
